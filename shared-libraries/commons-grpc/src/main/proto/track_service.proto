syntax = "proto3";

package com.github.fckng0d.trackservice;

option java_multiple_files = true;
option java_package = "com.github.fckng0d.grpc.trackservice";
option java_outer_classname = "TrackServiceProto";

import "google/protobuf/wrappers.proto";
import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";

service TrackService {
  rpc CreateTrack (CreateTrackRequest) returns (TrackPreviewResponse);
  rpc DeleteTrack (TrackByIdRequest) returns (google.protobuf.Empty);

  rpc GetTrackById (TrackByIdRequest) returns (TrackResponse);
  rpc GetTrackPreviewsByAlbumId (AlbumIdRequest) returns (TrackPreviewListResponse);
}

message CreateTrackRequest {
  string album_id = 1;
  string name = 2;
  repeated string languages = 3;
  repeated string genres = 4;
  repeated string musician_nicknames = 5;
  string lyrics = 6;
  bool is_explicit = 7;
  UploadFileRequest cover_image = 8;
  UploadFileRequest track_file = 9;
}

message UploadFileRequest {
  string file_name = 1;
  bytes file_data = 2;
}

message TrackResponse {
  int64 id = 1;
  string name = 2;
  string track_url = 3;
  int32 duration_seconds = 4;
  google.protobuf.Timestamp release_date = 5;
  repeated string languages = 6;
  repeated string genres = 7;
  string lyrics = 8;
  string cover_image_url = 9;
  string album_id = 10;
  repeated string musician_nicknames = 11;
  bool is_available = 12;
  bool is_explicit = 13;
  int64 audition_count = 14;
  int64 track_in_favorites_count = 15;
}

message TrackPreviewResponse {
  int64 id = 1;
  string name = 2;
  string track_url = 3;
  int32 duration_seconds = 4;
  string lyrics = 5;
  string cover_image_url = 6;
  string album_id = 7;
  repeated string musician_nicknames = 8;
  bool is_available = 9;
  bool is_explicit = 10;
  int64 audition_count = 11;
  int64 track_in_favorites_count = 12;
}

message AlbumIdRequest{
  string album_id = 1;
}

message TrackPreviewListResponse {
  repeated TrackPreviewResponse tracks = 1;
}

message TrackByIdRequest {
  int64 track_id = 1;
}